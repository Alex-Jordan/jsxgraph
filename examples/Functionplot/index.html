<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <meta name="viewport" content="width=default-width; user-scalable=no" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">

    <title>JSXGraph function plot</title>
	<link rel="stylesheet" type="text/css" media="screen" href="css/style.css" />
	<script type="text/javascript" src="jsxgraphcore.js"></script>
	
	<!-- iPad/iPhone specific css below, add after your main css >
	<link rel="stylesheet" media="only screen and (max-device-width: 1024px)" href="ipad.css" type="text/css" />		
	<link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="iphone.css" type="text/css" />		
	-->
	<!-- script type="text/javascript" charset="utf-8" src="phonegap.js"></script -->
    <script type="text/javascript">
    JXG.Options.showCopyright = true;
    colorArray = ['#0F408D','#6F1B75','#CA147A','#DA2228','#E8801B','#FCF302','#8DC922','#15993C','#87CCEE','#0092CE'];
    plotNr = 0;
    options = {
            strokeWidth:2,
            showDerivative:false
        };

	function init() {
		// set board settings dependent on device
		if(navigator.userAgent.match(/iPad/i)) {
			// we are on an iPad
			document.getElementById('jxgboxDiv').style.width  = '760px';
			document.getElementById('jxgboxDiv').style.height = '835px';
			document.getElementById('optionDiv').style.display  = 'none';
			document.getElementById('optionDiv').style.width  = '760px';
			document.getElementById('optionDiv').style.height = '835px';
		} else if(navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i)) {
			// we are on an iPhone/iPod Touch
			document.getElementById('jxgboxDiv').style.width  = '312px';
			document.getElementById('jxgboxDiv').style.height = '291px';
			document.getElementById('optionDiv').style.display  = 'none';
			document.getElementById('optionDiv').style.width  = '312px';
			document.getElementById('optionDiv').style.height = '291px';
		} else {
			// default settings - same like iPhone/iPod
			document.getElementById('jxgboxDiv').style.width  = '312px';
			document.getElementById('jxgboxDiv').style.height = '291px';
			document.getElementById('optionDiv').style.display  = 'none';
			document.getElementById('optionDiv').style.width  = '312px';
			document.getElementById('optionDiv').style.height = '291px';
		}
		board = JXG.JSXGraph.initBoard('jxgboxDiv', {axis:true, grid:true, boundingbox:[-2,1.2,2,-1.2]});
		restoreOptions();
	};
	
	function toggleOptionsView() {
		var opt = document.getElementById('optionDiv'),
            jsx = document.getElementById('jxgboxDiv');
		if(opt.style.display == 'none') {
			opt.style.display = 'block';
            jsx.style.display = 'none';
		} else {
			opt.style.display = 'none';
            jsx.style.display = 'block';
		}
	};
	
	function plotter() {
		var t = JXG.GeonextParser.geonext2JS(document.getElementById('input').value);
		var f = new Function('x','var y = '+t+'; return y;');
        var color = colorArray[plotNr%colorArray.length]; plotNr++;
		board.create('functiongraph',[f],{strokeColor:color, strokeWidth:options.strokeWidth});
		if (options.showDerivative) {
            board.create('functiongraph',[JXG.Math.Numerics.D(f)],{strokeColor:color, strokeWidth:options.strokeWidth, dash:2});
        }
	};
	
	/**
	 * Option handling
	 */
	function save() {
        // Speichere die Optionen und gehe wieder zurueck
        options.strokeWidth = localStorage.getItem('strokeWidth');
        options.showDerivative = localStorage.getItem('showDerivative');
		localStorage.setItem('strokeWidth', document.getElementById('strokeWidth').value);
		localStorage.setItem('showDerivative', document.getElementById('showDerivative').checked);
		toggleOptionsView();
    };
    function cancel() {
        // Speichere die Optionen und gehe wieder zurueck
        restoreOptions();
        toggleOptionsView();
    };
    
	function reset() {
		/*
		localStorage.setItem('strokeWidth', default.value);//TODO: default value?
		localStorage.setItem('showDerivative', default.value);//TODO: default value?
		*/
		toggleOptionsView();
	};
	
	function restoreOptions() {
        document.forms[0].strokeWidth.value = localStorage.getItem('strokeWidth');
        document.forms[0].showDerivative.checked = localStorage.getItem('showDerivative');
	};
	
    </script>
  </head>
  <body onload="init();">
  	<div id="topbar">
		<div id="title">JSXGraph function plot</div>
		<div id="rightbutton"><a href="javascript:toggleOptionsView();">options</a></div>
	</div>

	<div id="tributton">
		<div class="links">
			<input value="sin(x)*x" id="input" type="input" /><a href="javascript:plotter()">plot</a><a href="index.html">clear</a>
		</div>
	</div>

	<div id="content" align="center">
		<!-- correct the box settings for iphone, ipad, rotatet ipad, ... -->
		<div id="optionDiv">
			<form action="" method="get">
			<div id="tributton">
				<div class="links">
		            <a href="javascript:save()">save</a><a href="javascript:cancel()">cancel</a><a href="javascript:reset()">reset</a>
				</div>
			</div>

			<div id="optionscontent" align="center">
				<!-- correct the box settings for iphone, ipad, rotatet ipad, ... -->
		        <ul class="pageitem">
		            <li>
						<span class="name">Stroke width</span>
						<input placeholder="" id="strokeWidth" type="text" />
					</li>
		            <li class="checkbox">
						<span class="name">Show derivative</span>
						<input id="showDerivative" type="checkbox" />
					</li>   
				</ul>
			</div>
		    </form>
		</div>
		<div id="jxgboxDiv" class="jxgbox"></div>
	</div>

	<div id="footer">
		<a class="noeffect" href="http://jsxgraph.org/">Powered by JSXGraph</a>
	</div>
  </body>
</html>